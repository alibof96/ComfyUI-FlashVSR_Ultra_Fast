# ComfyUI-FlashVSR_Ultra_Fast
åœ¨ä½æ˜¾å­˜ç¯å¢ƒä¸‹è¿è¡Œ FlashVSRï¼ŒåŒæ—¶ä¿æŒæ— ä¼ªå½±é«˜è´¨é‡è¾“å‡ºã€‚  
**[[ğŸ“ƒEnglish](./readme.md)]**

## æ›´æ–°æ—¥å¿—
#### 2025-10-30
- æ–°å¢æ‰¹å¤„ç†åŠŸèƒ½ï¼Œæ”¯æŒé…ç½® `batch_size` å’Œ `frame_overlap` å‚æ•°
- å®ç°å¸§é‡å æ··åˆæŠ€æœ¯ï¼Œç¡®ä¿æ‰¹æ¬¡é—´çš„æ—¶é—´ä¸€è‡´æ€§å’Œå¹³æ»‘è¿‡æ¸¡
- æ·»åŠ å®Œæ•´æ€§æ£€æŸ¥ï¼Œç¡®ä¿è¾“å‡ºå¸§æ•°ä¸è¾“å…¥å¸§æ•°åŒ¹é…
- ä¼˜åŒ–å¼ é‡æ“ä½œï¼Œæå‡æ€§èƒ½

#### 2025-10-24
- æ–°å¢é•¿è§†é¢‘ç®¡é“, å¯æ˜¾è‘—é™ä½é•¿è§†é¢‘æ”¾å¤§çš„æ˜¾å­˜ç”¨é‡  

#### 2025-10-21
- é¡¹ç›®é¦–æ¬¡å‘å¸ƒ, å¼•å…¥äº†`tile_dit`ç­‰åŠŸèƒ½, å¤§å¹…åº¦é™ä½æ˜¾å­˜éœ€æ±‚  

#### 2025-10-22
- ä½¿ç”¨`Sparse_SageAttention`æ›¿æ¢äº†`Block-Sparse-Attention`, æ— éœ€ç¼–è¯‘å®‰è£…ä»»ä½•è‡ªå®šä¹‰å†…æ ¸, å¼€ç®±å³ç”¨.  
- æ”¯æŒåœ¨ RTX50 ç³»åˆ—æ˜¾å¡ä¸Šè¿è¡Œ.  

## é¢„è§ˆ
![](./img/preview.jpg)

## ä½¿ç”¨è¯´æ˜
- **modeï¼ˆæ¨¡å¼ï¼‰ï¼š**  
  `tiny` â†’ æ›´å¿«ï¼ˆé»˜è®¤ï¼‰ï¼›`full` â†’ æ›´é«˜è´¨é‡  
- **scaleï¼ˆæ”¾å¤§å€æ•°ï¼‰ï¼š**  
  é€šå¸¸ä½¿ç”¨ `4` æ•ˆæœæ›´å¥½ï¼›å¦‚æœæ˜¾å­˜ä¸è¶³ï¼Œå¯ä½¿ç”¨ `2`  
- **color_fixï¼ˆé¢œè‰²ä¿®æ­£ï¼‰ï¼š**  
  ä½¿ç”¨å°æ³¢å˜æ¢æ–¹æ³•ä¿®æ­£è¾“å‡ºè§†é¢‘çš„é¢œè‰²åå·®ã€‚  
- **tiled_vaeï¼ˆVAEåˆ†å—è§£ç ï¼‰ï¼š**  
  å¯ç”¨åå¯æ˜¾è‘—é™ä½æ˜¾å­˜å ç”¨ï¼Œä½†ä¼šé™ä½è§£ç é€Ÿåº¦ã€‚  
- **tiled_ditï¼ˆDiTåˆ†å—è®¡ç®—ï¼‰ï¼š**  
  å¤§å¹…å‡å°‘æ˜¾å­˜å ç”¨ï¼Œä½†ä¼šé™ä½æ¨ç†é€Ÿåº¦ã€‚  
- **tile_size / tile_overlapï¼ˆåˆ†å—å¤§å°ä¸é‡å ï¼‰ï¼š**  
  æ§åˆ¶è¾“å…¥è§†é¢‘åœ¨æ¨ç†æ—¶çš„åˆ†å—æ–¹å¼ã€‚  
- **unload_ditï¼ˆå¸è½½DiTæ¨¡å‹ï¼‰ï¼š**  
  è§£ç å‰å¸è½½ DiT æ¨¡å‹ä»¥é™ä½æ˜¾å­˜å³°å€¼ï¼Œä½†ä¼šç•¥å¾®é™ä½é€Ÿåº¦ã€‚
- **batch_sizeï¼ˆæ‰¹å¤„ç†å¤§å°ï¼‰ï¼š**  
  æ¯æ‰¹å¤„ç†çš„å¸§æ•°ã€‚é»˜è®¤å€¼ `1` ç¦ç”¨æ‰¹å¤„ç†ï¼ˆä¸€æ¬¡å¤„ç†æ‰€æœ‰å¸§ï¼‰ã€‚è®¾ç½®æ›´é«˜çš„å€¼ï¼ˆå¦‚ `30-50`ï¼‰å¯å¯ç”¨æ‰¹å¤„ç†ï¼Œæå‡é•¿è§†é¢‘æ¨ç†é€Ÿåº¦ã€‚ä»…å½“å¤„ç†çš„å¸§æ•°è¶…è¿‡æ‰¹å¤„ç†å¤§å°æ—¶ç”Ÿæ•ˆã€‚
- **frame_overlapï¼ˆå¸§é‡å æ•°ï¼‰ï¼š**  
  æ‰¹æ¬¡é—´é‡å çš„å¸§æ•°ï¼Œç”¨äºä¿æŒæ—¶é—´ä¸€è‡´æ€§ã€‚æ¨èå€¼ï¼š`2-4` å¸§ã€‚è®¾ä¸º `0` å¯ç¦ç”¨é‡å ã€‚é€šè¿‡æ··åˆé‡å å¸§æ¥ä¿æŒæ‰¹æ¬¡é—´çš„å¹³æ»‘è¿‡æ¸¡ã€‚ä»…åœ¨ `batch_size > 1` æ—¶ä½¿ç”¨ã€‚  

## å®‰è£…æ­¥éª¤

#### å®‰è£…èŠ‚ç‚¹:
```bash
cd ComfyUI/custom_nodes
git clone https://github.com/lihaoyun6/ComfyUI-FlashVSR_Ultra_Fast.git
python -m pip install -r ComfyUI-FlashVSR_Ultra_Fast/requirements.txt
```
#### æ¨¡å‹ä¸‹è½½:
- ä»[è¿™é‡Œ](https://huggingface.co/JunhaoZhuang/FlashVSR)ä¸‹è½½æ•´ä¸ª`FlashVSR`æ–‡ä»¶å¤¹å’Œå®ƒé‡Œé¢çš„æ‰€æœ‰æ–‡ä»¶, å¹¶å°†å…¶æ”¾åˆ°`ComfyUI/models`ç›®å½•ä¸­ã€‚  

```
â”œâ”€â”€ ComfyUI/models/FlashVSR
|     â”œâ”€â”€ LQ_proj_in.ckpt
|     â”œâ”€â”€ TCDecoder.ckpt
|     â”œâ”€â”€ diffusion_pytorch_model_streaming_dmd.safetensors
|     â”œâ”€â”€ Wan2.1_VAE.pth
```

## è‡´è°¢
- [FlashVSR](https://github.com/OpenImagingLab/FlashVSR) @OpenImagingLab  
- [Sparse_SageAttention](https://github.com/jt-zhang/Sparse_SageAttention_API) @jt-zhang
- [ComfyUI](https://github.com/comfyanonymous/ComfyUI) @comfyanonymous
